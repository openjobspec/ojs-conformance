{
  "test_id": "L0-ENV-002",
  "level": 0,
  "category": "envelope",
  "name": "valid-full-job",
  "description": "Enqueue a job with ALL optional attributes (meta, priority, timeout, scheduled_at in the past, retry, unique). Verify that every client-provided attribute is preserved in the response.",
  "spec_ref": "ojs-core#section-5.2",
  "tags": ["level-0", "envelope", "optional-fields", "happy-path"],
  "steps": [
    {
      "id": "step-1",
      "action": "POST",
      "path": "/ojs/v1/jobs",
      "headers": {
        "Content-Type": "application/openjobspec+json"
      },
      "body": {
        "type": "report.generate",
        "args": [42, "quarterly", {"include_charts": true}],
        "meta": {
          "trace_id": "4bf92f3577b34da6a3ce929d0e0e4736",
          "user_id": "usr_12345",
          "tenant_id": "tenant_acme",
          "correlation_id": "corr_report_q4_2026",
          "tags": ["quarterly", "finance"]
        },
        "options": {
          "queue": "reports",
          "priority": 10,
          "timeout_ms": 300000,
          "delay_until": "2020-01-01T00:00:00Z",
          "retry": {
            "max_attempts": 5,
            "initial_interval": "PT1S",
            "backoff_coefficient": 2.0,
            "max_interval": "PT5M",
            "jitter": true,
            "non_retryable_errors": ["ValidationError", "AuthenticationError"]
          },
          "unique": {
            "keys": ["type", "args"],
            "period": "PT1H",
            "on_conflict": "reject"
          }
        }
      },
      "assertions": {
        "status": 201,
        "body": {
          "$.job.id": "string:uuidv7",
          "$.job.type": "report.generate",
          "$.job.state": "available",
          "$.job.queue": "reports",
          "$.job.args[0]": 42,
          "$.job.args[1]": "quarterly",
          "$.job.args[2].include_charts": true,
          "$.job.meta.trace_id": "4bf92f3577b34da6a3ce929d0e0e4736",
          "$.job.meta.user_id": "usr_12345",
          "$.job.meta.tenant_id": "tenant_acme",
          "$.job.meta.correlation_id": "corr_report_q4_2026",
          "$.job.meta.tags[0]": "quarterly",
          "$.job.meta.tags[1]": "finance",
          "$.job.priority": 10,
          "$.job.attempt": 0,
          "$.job.created_at": "string:datetime",
          "$.job.enqueued_at": "string:datetime"
        }
      }
    }
  ]
}
