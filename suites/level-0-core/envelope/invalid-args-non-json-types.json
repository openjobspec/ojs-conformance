{
  "test_id": "L0-ENV-008",
  "level": 0,
  "category": "envelope",
  "name": "invalid-args-non-json-types",
  "description": "Verify that args containing only JSON-native types are accepted. Since JSON itself only supports native types (string, number, boolean, null, array, object), this test verifies that deeply nested and mixed-type args arrays are handled correctly. All values submitted are valid JSON-native types and MUST be accepted and preserved.",
  "spec_ref": "ojs-core#section-5.1, L0-ENV-005",
  "tags": [
    "level-0",
    "envelope",
    "validation",
    "args-format",
    "json-native"
  ],
  "steps": [
    {
      "id": "step-1-nested-complex-args",
      "action": "POST",
      "intent": "enqueue",
      "path": "/ojs/v1/jobs",
      "headers": {
        "Content-Type": "application/openjobspec+json"
      },
      "body": {
        "type": "data.process",
        "args": [
          "string_value",
          42,
          3.14,
          true,
          false,
          null,
          [
            1,
            "two",
            [
              3,
              [
                4,
                5
              ]
            ]
          ],
          {
            "nested": {
              "deeply": {
                "key": "value",
                "numbers": [
                  1,
                  2,
                  3
                ],
                "mixed": [
                  null,
                  true,
                  "text",
                  99.9
                ]
              }
            }
          }
        ]
      },
      "assertions": {
        "status": 201,
        "body": {
          "$.job.id": "string:uuidv7",
          "$.job.type": "data.process",
          "$.job.state": "available",
          "$.job.args[0]": "string_value",
          "$.job.args[1]": 42,
          "$.job.args[2]": 3.14,
          "$.job.args[3]": true,
          "$.job.args[4]": false,
          "$.job.args[5]": null,
          "$.job.args[6][0]": 1,
          "$.job.args[6][1]": "two",
          "$.job.args[7].nested.deeply.key": "value"
        }
      }
    },
    {
      "id": "step-2-empty-args",
      "action": "POST",
      "intent": "enqueue",
      "path": "/ojs/v1/jobs",
      "headers": {
        "Content-Type": "application/openjobspec+json"
      },
      "body": {
        "type": "data.noop",
        "args": []
      },
      "assertions": {
        "status": 201,
        "body": {
          "$.job.id": "string:uuidv7",
          "$.job.type": "data.noop",
          "$.job.state": "available",
          "$.job.args": "array:length(0)"
        }
      }
    }
  ]
}
